const xlsx = require('xlsx'); function importUsersFromExcel(filePath){ const wb = xlsx.readFile(filePath); const sheet = wb.Sheets[wb.SheetNames[0]]; const data = xlsx.utils.sheet_to_json(sheet,{defval:''}); return data.map((row,i)=>({ member_number: row['member_number'] || ('USR-'+(1000+i)), document_number: row['document_number']||'', first_name: row['first_name']||'', last_name: row['last_name']||'', type: row['type']||'Externo', email: row['email']||'' })); } module.exports = { importUsersFromExcel };
